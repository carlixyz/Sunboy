<!DOCTYPE html>
<html  xmlns="http://www.w3.org/1999/html" style="background-size: 100%; background-image:url('images/black1926.jpg'); ">

<head>
    <title>SunHouse GameDev Studios</title>
    <link rel="icon" type="image/ico" href="favicon.ico">
    <link rel="shortcut icon" href="favicon.ico">
    <meta name="viewport" content="width=device-width"/>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link rel="stylesheet" type="text/css" href="style.css" >
    <script type="text/javascript" language="JavaScript" src="scripts/main.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/phaser.min.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunWorld.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunHome.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunBoy.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunPalms.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunCloud.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunPelican.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunCrab.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunCoco.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunHealth.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunApple.js"></script>
    <script type="text/javascript" language="JavaScript" src="scripts/sunBanana.js"></script>

    <!--<script type="text/javascript" src="/scripts/sunGame.js"></script>-->  <!--Game Logic added inside Body -->

</head>

<body  onload="run()" >


<div id="language">
    <img src="images/us.png" title="English (EN)" 	style="width:2.5%;" onclick="SetLang('en')" accesskey="U"/>
    <img src="images/br.png" title="PortuguÍs (PT)" style="width:2.5%;" onclick="SetLang('br')" accesskey="B"/>
    <img src="images/ar.png" title="EspaÒol (ES)" 	style="width:2.5%;" onclick="SetLang('es')" accesskey="A"/>
</div>

<header id="top">
    <div class="navigation">

        <div class="UpsideBand" style= ></div>
        <div class="DownsideBand" style= ></div>
        <div id="logo" >
            <a href="/">
                <h1 class="randomFont" >
                    <img src="images/logo.png"  alt="SunHouse">


                    SunHouse
                    <!--<embed src="images/isotipo_byn.svg" width="50px" height="50px" type="image/svg+xml" />-->
                    <!--<object data="images/isotipo_byn.svg" width="50px" height="50px" type="image/svg+xml"></object>-->
                </h1>
            </a>
        </div>
        <ul>
            <li  >
                <a href="news.html">
                    <div lang="es"> noticias </div>
                    <div lang="en" style="display: none;"> news </div>
                    <div lang="br" style="display: none;"> Informa«ao </div>
                </a>
            </li>
            <li >
                <a href="about.html">
                    <div lang="es"> acerca </div>
                    <div lang="en" style="display: none;"> about </div>
                    <div lang="br" style="display: none;"> nois </div>
                </a>
            </li >
            <li >
                <a href="works.html">
                    <div lang="es"> trabajos </div>
                    <div lang="en" style="display: none;"> works </div>
                    <div lang="br" style="display: none;"> trabalhos </div>
                </a>
            </li>
            <li >
                <a href="contact.html">
                    <div lang="es"> contacto </div>
                    <div lang="en" style="display: none;"> contact </div>
                    <div lang="br" style="display: none;"> contato </div>
                </a>
            </li>
        </ul>

    </div>

    <![if (gt IE 5)&(lt IE 8)]>
    <div class="UpsideBand" style="opacity: 0.5;" ></div>
    <div class="DownsideBand" style="opacity: 0.5;" ></div>
    <!--<h1>You're not using IE. Well done!</h1>-->
    <![endif]>

</header>


<div class="wrapper">


    <!--[if lt IE 9]>
    <div class="MSSUCKS">
    <![endif]--> <!-- MS IExplorer Check Up start-->

    <section  id="home" >
        <!--<img src="images/Home.gif" style="width: 100%;" alt="">-->

        <script type="text/javascript" language="JavaScript" >

            /* MAIN GAME SCRIPT SOURCE
            *
            *
            *
            *
            *
            */

            var game = new Phaser.Game(900, 480, Phaser.CANVAS, '', { preload: preload, create: create, update : update, render : render });

            var alreadyPlayed = false;
//            var play  = false;
//            var start = true;
//            var end   = false;
            var timeLapse = 20;
            var time = 0;
            var loops = 0;

            var score = 0;
            var topScore = 0;

            var healthText;
            var scoreText;  // Display score and topScore
            var infoText;   // Display Ready?, Loop N∞ & GameOver info

            var player ;
            var world;
            var house;

            var objects;
            var objectsIndex;
            var monsters;
            var monstersAmount = 3;

//            var shake;

            var states = {  INTRO: 0, START: 1, INGAME: 2, BUCLE: 3, GAMEOVER: 4 };

            function preload ()
            {
                game.physics.startSystem(Phaser.Physics.ARCADE);
                game.currentState = states.INTRO;

                Phaser.Canvas.addToDOM(game.canvas, "home", true);      // attach Phaser Canvas inside Web Content
                game.stage.backgroundColor = '#FFFFFF';

                player = new SunBoy(game);
                world = new SunWorld(game);
                house = new SunHome(game);

                game.load.image('cloud', 'images/sunCloud.png');
                game.load.image('palms', 'images/sunPalms.png');
                game.load.image('coco', 'images/sunCoco.png');
                game.load.image('apple', 'images/sunApple.png');
                game.load.image('banana', 'images/sunBanana.png');
                game.load.image('health', 'images/sunHeart.png');
                game.load.spritesheet('crab', 'images/sunCrab.png', 32, 1024, 4);
                game.load.spritesheet('bird', 'images/sunPelican.png', 32, 1024, 4);

                game.load.image('mask', 'images/sunMask.png');
//                shake = game.camera.fx.add(Phaser.FX.Camera.Shake);

            }

            function create ()
            {
                console.log("HI WORLD");
                console.log(currentFont);

                world.create(game, -360);
                house.create(game, 0);
                player.create(game, 0);


//                for (var i = 0, total = monsters.length-1; i < total; i++)
//                    monsters[i].create(game, Math.random() * 360);

                mask = game.add.sprite(game.world.centerX, game.world.centerY, 'mask');
                mask.anchor.setTo(0.5, 0.5);

                var style = { font: "12px MyriadPro-Regular", fill: "white", align: "center" };
                scoreText = game.add.text(game.world.centerX, game.world.centerY -110, "10000", style);
                scoreText.anchor.setTo(0.5,0.5);

                infoText = game.add.text(game.world.centerX, game.world.centerY -50, "READY?", style);
                infoText.anchor.setTo(0.5,0.5);

                healthText = game.add.text(game.world.centerX, game.world.centerY -85,new Array(4 ).join("\u2665"), style);
                healthText.anchor.setTo(0.5,0.5);

                // game.world.centerY - 110 == 130
//                game.add.tween(t).to({ y: 130 }, 5000, Phaser.Easing.Exponential.InOut, true, 100, false);

            }


            function update()
            {

                game.physics.arcade.collide(player.sprite, world.sprite);


                ///////////////////////////////////////////////////////////////////

                switch ( game.currentState )
                {
                    case states.INTRO:
                        timeLapse = 0;
                        player.sprite.visible = false;
                        player.sprite.body.allowGravity = false;
                        scoreText.visible = false;
                        infoText.visible = false;
                        healthText.visible = false;

//                      game.currentState = states.START; // set inside world.GrowTween(game);
                        break;

                    case states.START:
                            scoreText.setText(topScore) ;
                            score = loops = time = 0;
                            scoreText.visible = alreadyPlayed;


                            if ( (game.input.mousePointer.isDown || game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR))&&
                                    player.sprite.body.allowGravity == false)
                            {
                                alreadyPlayed = true;

                                infoText.visible = true;
                                infoText.setText("GET READY?") ;
                                infoText.alpha = 0;
//
                                player.sprite.visible = true;
                                player.resetIt();
                                player.sprite.animations.play('idle', 1, false);

//                                player.sprite.x = 435;
//                                player.sprite.y = 250;

                                healthText.setText( (function (){ for (var e = ''; e.length < player.sprite.health;)e += "\u2665"; return e;})() );
                                healthText.setText( new Array(player.sprite.health+1 ).join("\u2665") );
                                healthText.visible = true;

                                scoreText.setText(score);


                                game.add.tween(infoText).to({ alpha: 1 }, 2000, Phaser.Easing.Elastic.InOut, true, 100, false)
                                    .onComplete.add( function()
                                    {
                                        infoText.alpha = 1;
                                        infoText.setText("GO!");
                                        scoreText.visible = true;
                                        player.sprite.animations.play('run', 7, true);
                                        game.currentState = states.INGAME;

                                        game.add.tween(infoText).to({ alpha: 0 }, 2000, Phaser.Easing.Elastic.InOut, true, 100, false)
                                            .onComplete.add( function()
                                            {
                                                infoText.visible = false;
//                                                game.time.events.addOnce().add(Phaser.Timer.SECOND * 10, fadePicture, this);

                                            }
                                        )
                                    }
                                );
// Some optional code
//                                infoText.visible = true;
//                                infoText.content = "GET READY";
//                                infoText.alpha = 0;
//                                infoText.y = 400;
//
//                                game.add.tween(infoText).to({ alpha: 1, y: 190 }, 2000, Phaser.Easing.Elastic.Out, true, 100, false)
//                                        .onCompleteCallback( function()
//                                        {
//                                            infoText.content = "GO!";
//                                            scoreText.visible = true;
//                                            player.sprite.animations.play('run', 7, true);
//                                            game.currentState = states.INGAME;
//
//                                            game.add.tween(infoText).to({ alpha: 0, y: 0 }, 2000, Phaser.Easing.Elastic.In, true, 100, false)
//                                                    .onCompleteCallback( function()
//                                                    {
//                                                        infoText.visible = false;
//                                                    }
//                                            )
//                                        }
//                                );
                            }


                        break;

                    case states.INGAME:

                            scoreText.setText(score);
                            world.update(game);
                            house.update(game);

//                            for (var i = 0, total = monsters.length-1; i < total; i++)
//                                monsters[i].update(game);

                            player.update(game);

                        break;
                    case states.BUCLE:

                        infoText.visible = true;
                        infoText.content = "LOOP " + ++loops;
                        infoText.alpha = 0;

                        game.add.tween(house.sprite).to({ angle: 0 }, 3000, Phaser.Easing.Exponential.Out, true, 100, false)
                            .onComplete.add( function(){

                                player.sprite.animations.play('idle', 1, false);
//                                raiseMonsters(game);

                                game.add.tween(infoText).to({ alpha: 1 }, 2000, Phaser.Easing.Elastic.InOut, true, 100, false)
                                    .onComplete.add( function(){
                                        infoText.content = "GO!";
                                        scoreText.visible = true;
                                        player.sprite.animations.play('run', 7, true);
                                        game.currentState = states.INGAME;

                                        game.add.tween(infoText).to({ alpha: 0 }, 2000, Phaser.Easing.Elastic.InOut, true, 100, false)
                                            .onComplete.add( function(){
                                                infoText.visible = false;
                                            })
                                    })
                            });
                        break;
                    case states.GAMEOVER:
                        topScore = ( score > topScore ? score :  topScore) ;

                        if (player.flickering === false)
                        {
                            player.flickering = true;
                            game.add.tween(infoText).to({ alpha: 1 }, 3000, Phaser.Easing.Elastic.InOut, true, 100, false)
                                .onComplete.add( function()
                                {
                                    infoText.alpha = 1;
                                    infoText.setText("GAME OVER");
                                    infoText.visible = true;

                                    scoreText.visible = false;
                                    player.sprite.animations.play('idle', 7, true);
                                    console.log("Game Over State");

                                    game.add.tween(infoText).to({ alpha: 0 }, 4000, Phaser.Easing.Elastic.InOut, true, 100, false)
                                        .onComplete.add( function()
                                        {
                                            infoText.visible = false;
                                            player.sprite.visible = false;
                                            game.currentState = states.INTRO;
                                            player.flickering = false;
//                                            house.sprite.angle = 0;
                                            house.resetIt();
                                            world.GrowTween(game);
                                            house.GrowTween(game);

                                        }
                                    )
                                }
                            );
                        }
                        break;
                }
            }


            function hurtPlayer(game)
            {
                if (player.flickering === false)
                {
                    player.sprite.alpha = 0;
                    player.flickering = true;
                    player.sprite.damage( 1);
                    healthText.setText( (function (){ for (var e = ''; e.length < player.sprite.health;)e += "\u2665"; return e;})() );

                    game.add.tween(player.sprite).to({ alpha: 1 }, 2000, Phaser.Easing.Elastic.InOut, true, 100, false)
                        .onComplete.add( function()
                        {
                            player.flickering = false;
                            console.log("player hurted");

                            if (player.sprite.health <= 0)
                            {
                                infoText.visible = true;
                                infoText.alpha = 0;
                                infoText.setText("FALLASTE");
                                game.currentState = states.GAMEOVER;
                            }

                        }
                    );
                }
            }

            function raiseMonsters(game)
            {
                monsters = [100];
                monstersAmount = 1;
                var sec = [2, 3, 5, 8, 13, 21, 34, 55, 89, 100]; // a small sequence to distribute better the enemy amount

                for (var i = 0, total = sec[monstersAmount]; i < total; i++)
                {
                    monsters[i] = null;
//                    delete monsters[i] ;

                    if (Math.random() > .5)
                        monsters[i] = new SunCrab(game);
                    else
                        monsters[i] = new SunPelican(game);

                    monsters[i].create(game, 45 + Math.random() * 270);
                }

//                for (var i = 0, total = monsters.length-1; i < total; i++)
                    monsters[i].create(game, Math.random() * 360);
            }

            function takeItem(itemType)
            {
                console.log("taken " + itemType);
            }


            function resetGame()
            {

            }

            function render() {

                // Sprite debug info
//                palms.render();
//                cloud.render();
//                world.render();
//                player.render();
                //                game.debug.renderSpriteInfo(world, 32, 32);
//                game.debug.renderLocalTransformInfo(world, 32, 160);
//                game.debug.renderWorldTransformInfo(world, 32, 290);

//                game.debug.renderText("Time until event: " + game.time.events.duration, 32, 32);
            }

        </script>


    </section>

    <!--[if lt IE 9]>
    </div>
    <![endif]--> <!-- MS IExplorer Check Up End-->

</div>


</body>

</html>